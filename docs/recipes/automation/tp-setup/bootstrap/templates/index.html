<!--
  ~ Copyright (c) 2025. Cloud Software Group, Inc. All Rights Reserved. Confidential & Proprietary
  -->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>One-Click Setup of the Control Plane</title>
  <!-- mini.css: https://minicss.us/docs.htm -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mini.css/3.0.1/mini-default.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.30.0/themes/prism-tomorrow.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.30.0/components/prism-core.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.30.0/plugins/autoloader/prism-autoloader.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='index.css') }}" />
</head>
<body>
<div class="container">
  <h1>
    <span>One-Click Setup of the Control Plane</span>
    <a href="https://github.com/TIBCOSoftware/platform-provisioner/tree/main/docs/recipes/automation/tp-setup/bootstrap" target="_blank"
       title="View supported features" class="release_version" id="TP_AUTOMATION_TASK_RELEASE_VERSION"></a>
  </h1>
  <!-- Loading spinner begin -->
  <input type="checkbox" class="modal" checked="checked">
  <div class="is_loading">
    <div class="spinner"></div>
  </div>
  <!-- Loading spinner end -->

  <div class="tabs">
    <button class="button tab-button active" data-target="#tab1">GUI</button>
    <button class="button tab-button" data-target="#tab2">CLI</button>
  </div>

  <div id="tab1" class="tab-content active">
    <form>
      <fieldset>
        <legend>Environment</legend>
        <div class="row">
          <div class="col-sm-6">
            <div class="row TP_AUTO_ADMIN_URL">
              <div class="col-sm-3"><label for="TP_AUTO_ADMIN_URL">CP Admin URL</label></div>
              <div class="col-sm-9"><input type="text" id="TP_AUTO_ADMIN_URL"></div>
            </div>

            <div class="row CP_ADMIN_EMAIL">
              <div class="col-sm-3"><label for="CP_ADMIN_EMAIL">Admin Email</label></div>
              <div class="col-sm-9"><input type="text" id="CP_ADMIN_EMAIL"></div>
            </div>

            <div class="row CP_ADMIN_PASSWORD">
              <div class="col-sm-3"><label for="CP_ADMIN_PASSWORD">Admin Password</label></div>
              <div class="col-sm-9"><input type="text" id="CP_ADMIN_PASSWORD"></div>
            </div>

            <div class="row TP_AUTO_LOGIN_URL">
              <div class="col-sm-3"><label for="TP_AUTO_LOGIN_URL">CP Login URL</label></div>
              <div class="col-sm-9"><input type="text" id="TP_AUTO_LOGIN_URL"></div>
            </div>
            <div class="row DP_HOST_PREFIX">
              <div class="col-sm-3"><label for="DP_HOST_PREFIX">Host Prefix</label></div>
              <div class="col-sm-9"><input type="text" id="DP_HOST_PREFIX"></div>
            </div>

            <div class="row">
              <div class="col-sm-3"><label for="DP_USER_EMAIL">User Email</label></div>
              <div class="col-sm-9"><input type="text" id="DP_USER_EMAIL"></div>
            </div>

            <div class="row">
              <div class="col-sm-3"><label for="DP_USER_PASSWORD">User Password</label></div>
              <div class="col-sm-9"><input type="text" id="DP_USER_PASSWORD"></div>
            </div>

            <div class="row TP_AUTO_MAIL_URL">
              <div class="col-sm-3"><label for="TP_AUTO_MAIL_URL">Mail Server URL</label></div>
              <div class="col-sm-9"><input type="text" id="TP_AUTO_MAIL_URL"></div>
            </div>

            <div class="row TP_AUTO_K8S_DP_NAME">
              <div class="col-sm-3"><label for="TP_AUTO_K8S_DP_NAME">DataPlane Name</label></div>
              <div class="col-sm-9"><input type="text" id="TP_AUTO_K8S_DP_NAME"></div>
            </div>
            <div class="row TP_AUTO_K8S_BMDP_NAME">
              <div class="col-sm-3"><label for="TP_AUTO_K8S_BMDP_NAME" title="If it doesn't exist, even if it is set, it won't be configured">DataPlane Name<span>(Control Plane)</span></label></div>
              <div class="col-sm-9"><input type="text" id="TP_AUTO_K8S_BMDP_NAME"></div>
            </div>
          </div>
          <div class="col-sm-6">
            <div class="row TP_AUTO_KUBECONFIG">
              <div class="col-sm-3">
                <label for="TP_AUTO_KUBECONFIG">KUBECONFIG Path<span>(Optional)</span></label>
              </div>
              <div class="col-sm-9">
                <input type="text" id="TP_AUTO_KUBECONFIG" title="Use system default KUBECONFIG if not set">
              </div>
            </div>

            <div class="row">
              <div class="col-sm-3 HEADLESS"><label for="HEADLESS" title="Will run test case in the popup browser">Run in Browser</label></div>
              <div class="col-sm-3 HEADLESS"><input type="checkbox" id="HEADLESS"></div>
              <div class="col-sm-3"><label for="FORCE_RUN_AUTOMATION" title="Will pre-set required steps if it is selected(Not include create dataplane.)">Force Run Automation</label></div>
              <div class="col-sm-3"><input type="checkbox" id="FORCE_RUN_AUTOMATION"></div>
            </div>
            <div class="row IS_CLEAN_REPORT">
              <div class="col-sm-3"><label for="IS_CLEAN_REPORT" title="Will delete report folder if selected">Is clean report folder</label></div>
              <div class="col-sm-3"><input type="checkbox" id="IS_CLEAN_REPORT"></div>
              <div class="col-sm-3"></div>
              <div class="col-sm-3"></div>
            </div>

            <div class="row">
              <div class="col-sm-3"><label for="guiAutoCase">Automation Case</label></div>
              <div class="col-sm-9">
                <select id="guiAutoCase">
                  <option>--Select Case--</option>
                  <option value="page_env">Show Current Environment (Login CP/Elastic Credentials)</option>
                  <option value="page_auth">Create new subscription with User Email</option>
                  <option value="page_o11y">Config o11y widget</option>
                  <optgroup label="DataPlane">
                    <option value="case.create_global_config">Config Global O11y</option>
                    <option value="case.k8s_create_dp">Create K8s DataPlane (Include run helm command)</option>
                    <option value="case.k8s_config_dp_o11y">Config DataPlane O11y</option>
                    <option value="case.k8s_delete_dp">Delete DataPlane (Include run helm command)</option>
                  </optgroup>
                  <optgroup label="Provision Capability">
                    <option value="provision_bwce">Provision BWCE</option>
                    <option value="provision_ems">Provision EMS</option>
                    <option value="provision_flogo">Provision Flogo</option>
                    <option value="provision_pulsar">Provision Pulsar</option>
                    <option value="provision_tibcohub">Provision TibcoHub</option>
                  </optgroup>
                  <optgroup label="Create And Start app">
                    <option value="case.k8s_create_and_start_bwce_app">Create And Start BWCE App (Include set endpoint to public and Test swagger API)</option>
                    <option value="case.k8s_create_and_start_flogo_app">Create And Start Flogo App (Include set endpoint to public and Test swagger API)</option>
                  </optgroup>
                  <optgroup label="Delete app">
                    <option value="delete_bwce_app">Delete BWCE App</option>
                    <option value="delete_flogo_app">Delete Flogo App</option>
                  </optgroup>
                </select>
              </div>
            </div>

            <div class="row app_file">
              <div class="col-sm-3">
                <label>App File<span>(Optional)</span></label>
              </div>
              <div class="col-sm-7">
                <input type="file" id="app_file" accept=".ear,.json,.flogo" title="Will use the default Flogo(.json, .flogo) or BWCE(*.ear) file if no file is chosen." />
              </div>
              <div class="col-sm-2"></div>
            </div>

            <div class="row TP_AUTO_DATA_PLANE_O11Y_SYSTEM_CONFIG">
              <div class="col-sm-3"><label for="TP_AUTO_DATA_PLANE_O11Y_SYSTEM_CONFIG">Is Using O11y System Config</label></div>
              <div class="col-sm-9"><input type="checkbox" id="TP_AUTO_DATA_PLANE_O11Y_SYSTEM_CONFIG"></div>
            </div>

            <div class="row BWCE_APP_NAME">
              <div class="col-sm-3"><label for="BWCE_APP_NAME">BWCE app name</label></div>
              <div class="col-sm-9"><input type="text" id="BWCE_APP_NAME"></div>
            </div>

            <div class="row FLOGO_APP_NAME">
              <div class="col-sm-3"><label for="FLOGO_APP_NAME">Flogo app name</label></div>
              <div class="col-sm-9"><input type="text" id="FLOGO_APP_NAME"></div>
            </div>

            <div class="row TP_AUTO_K8S_DP_SERVICE_ACCOUNT_CREATION_ADDITIONAL_SETTINGS">
              <div class="col-sm-3">
                <label for="TP_AUTO_K8S_DP_SERVICE_ACCOUNT_CREATION_ADDITIONAL_SETTINGS" class="flex-column">
                  <span><a href="https://docs.tibco.com/pub/platform-cp/1.5.0/doc/html/Default.htm#UserGuide/controlling-traffic-with-network-policies.htm?Highlight=network%20policy" target="_blank">Additional Settings</a> for creating K8S DataPlane</span>
                  <span>Step 3. Service Account creation</span>
                </label>
              </div>
              <div class="col-sm-9"><textarea type="text" id="TP_AUTO_K8S_DP_SERVICE_ACCOUNT_CREATION_ADDITIONAL_SETTINGS"></textarea></div>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-sm-6">
            <div class="row">
              <div class="col-sm-3"></div>
              <div class="col-sm-9">
                <button type="button" class="runBtn primary" onclick="runGuiScript(this)">Run</button>
                <button type="button" class="stopBtn secondary" onclick="stopScript(this)" disabled>Stop</button>
              </div>
            </div>
          </div>
        </div>
      </fieldset>
      <pre class="logs language-log"><code class="output"></code></pre>
    </form>
  </div>

  <div id="tab2" class="tab-content">
    <form>
      <fieldset>
        <legend>Environment</legend>
        <div class="row">
          <div class="col-sm-6">
            <div class="row TIBCOP_CLI_CPURL">
              <div class="col-sm-3"><label for="TIBCOP_CLI_CPURL">CP URL</label></div>
              <div class="col-sm-9"><input type="text" id="TIBCOP_CLI_CPURL" title="Do not include the trailing slash" /></div>
            </div>

            <div class="row TIBCOP_CLI_OAUTH_TOKEN">
              <div class="col-sm-3"><label for="TIBCOP_CLI_OAUTH_TOKEN">CLI Token</label></div>
              <div class="col-sm-9"><input type="text" id="TIBCOP_CLI_OAUTH_TOKEN" title="Get it from 'CP' -> 'Settings' -> 'OAuth Token'"/></div>
            </div>

            <div class="row TIBCOP_CLI_DP_NAME">
              <div class="col-sm-3"><label for="TIBCOP_CLI_DP_NAME">DataPlane Name</label></div>
              <div class="col-sm-9"><input type="text" id="TIBCOP_CLI_DP_NAME"></div>
            </div>

          </div>
          <div class="col-sm-6">
            <div class="row">
              <div class="col-sm-3"><label for="cliAutoCase">Automation Case</label></div>
              <div class="col-sm-9">
                <select id="cliAutoCase">
                  <option>--Select Case--</option>
                  <optgroup label="TIBCO Platform Commands">
                    <option value="tplatform:list-dataplanes">tplatform:list-dataplanes</option>
                    <option value="tplatform:register-k8s-dataplane">tplatform:register-k8s-dataplane</option>
                    <option value="tplatform:unregister-dataplane">tplatform:unregister-dataplane</option>
                  </optgroup>
                </select>
              </div>
            </div>

            <div class="row">
              <div class="col-sm-3">
                <label for="TIBCOP_CLI_OTHER_ARGS" class="flex-column">
                  <span><a href="https://docs.tibco.com/pub/platform-cp/1.7.0/doc/html/Default.htm#CLI/platform-cli-reference.htm?TocPath=TIBCO%2520Platform%2520CLI%257CTIBCO%2520Platform%2520CLI%2520Reference" target="_blank">Additional Command Flags</a></span>
                </label>
              </div>
              <div class="col-sm-9"><textarea type="text" id="TIBCOP_CLI_OTHER_ARGS"></textarea></div>
            </div>

          </div>
        </div>

        <div class="row">
          <div class="col-sm-6">
            <div class="row">
              <div class="col-sm-3">
                <label for="SAVE_CLI_SETTING" title="Uncheck, then check again to save settings.">
                  <input type="checkbox" id="SAVE_CLI_SETTING" onclick="saveCliSetting(this)">Save Setting
                </label>
              </div>
              <div class="col-sm-9">
                <button type="button" class="runBtn primary" onclick="runCliScript(this)">Run</button>
                <button type="button" class="stopBtn secondary" onclick="stopScript(this)" disabled>Stop</button>
              </div>
            </div>
          </div>
        </div>
      </fieldset>
      <pre class="logs language-log"><code class="output"></code></pre>
    </form>
  </div>
</div>

<script src="{{ url_for('static', filename='index.js') }}" type="text/javascript"></script>
</body>
</html>
